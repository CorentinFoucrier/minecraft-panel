{% extends "layout/base.html.twig" %}

{% block content %}
    {# Version infos #}
    <div class="row mt-3">
        <div class="col-md-5 pr-md-5">
            <div class="card">
                <div class="card-header h5">
                    <b>{{ lang('dashboard.controls') }}</b>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-5">
                            <div class="d-flex justify-content-center" style="">
                                <spinning-dots id="spin" class="d-none" style="width:70px;stroke-width:5px;color:#FFF;" dots="13"></spinning-dots>
                                <img id="versionLogo" class="img-fluid" src="{{ uri('base') }}assets/img/{{versionType}}.png" alt="Logo de la version">
                            </div>
                        </div>
                        <div class="col-7 d-flex justify-content-center flex-column">
                            <b>{{ lang('dashboard.version') }}</b>
                            <p><span id="vType">{{versionType}}</span> <span id="vNumber">{{versionNumber}}</span></p>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-12" style="height:1em;">
                            <div class="d-flex justify-content-center position-relative" style="top:110%;">
                                <div class="btn-group">
                                    <button id="ctrlBtn" type="button" class="btn btn-dark">...</button>
                                    <button type="button" class="btn btn-dark" data-toggle="modal" data-target="#changeVersion"><i class="fas fa-cog"></i></button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        {# Server Management #}
        <div class="col-md-7">
            <div class="card">
                <h5 class="card-header">
                    <b>{{ lang('dashboard.stats') }}</b>
                </h5>
                <div class="card-body p-3">
                    <div class="row">
                        <div class="col-md-8 text-center">
                            <canvas id="cpuChart" style="background:#3B3B3B;border-radius:0px;width:500px;height:200px;padding-left:0px;padding-right:0px;padding-top:0px;padding-bottom:0px"></canvas>
                            <div class="d-flex justify-content-center">
                                <div><i class="fas fa-microchip h2"></i></div>
                                <div class="pl-2">{{ lang('dashboard.stats.cpu') }} <span id="cpu">N/A</span>%</div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            {# RAM INFOS #}
                            <div class="row pb-1">
                                <div class="col-md-4 p-0 d-md-flex justify-content-md-center">
                                    <i class="fas fa-memory h2 pt-2"></i>
                                </div>
                                <div class="col-md-8 p-0">
                                    <b>{{ lang('dashboard.stats.ram') }}</b>
                                    <br />
                                    <span id="ram">0</span> / {{ramMax}} MB
                                </div>
                            </div>
                            {# PLAYERS INFOS #}
                            <div class="row justify-content-center align-content-center pb-1">
                                <div class="col-md-4">
                                    <i class="fas fa-user-friends h2 pt-4"></i>
                                </div>
                                <div class="col-md-8 p-0">
                                    <b>{{ lang('dashboard.stats.players') }}</b>
                                    <br />
                                    {{ lang('dashboard.stats.total') }} {% if maxPlayers %} {{ maxPlayers }} {% else %} ? {% endif %}
                                    <br />
                                    {{ lang('dashboard.stats.logged') }} <span id="playersOnline">0</span>
                                </div>
                            </div>
                            {# SOME INFOS #}
                            <div class="row">
                                <div class="col-12">
                                    <b>{{ lang('dashboard.stats.infos') }}</b>
                                    <br />
                                    {{ lang('dashboard.stats.whitelist') }} {{ (whitelist == "true") ? 'ON' : 'OFF' }}
                                    <br />
                                    {{ lang('dashboard.stats.port') }} {{serverPort}}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    {# Console #}
    <div class="row mt-5">
        <div class="offset-md-1 col-md-10">
            <div class="card">
                <h5 class="card-header">
                    <b>{{ lang('dashboard.console.title') }}</b>
                </h5>
                <div class="row no-gutters">
                    <div class="col-12 p-md-2">
                        <div class="card-body py-md-0">
                            <div class="row">
                                {# Console renderer #}
                                <div id="log" class="border pl-1 overflow" style="height:250px;"></div>
                            </div>

                            <div class="row pt-2">
                                <div class="input-group">
                                    <div class="input-group-prepend">
                                        <div class="input-group-text bg-dark">
                                            <i class="fas fa-terminal"></i>
                                        </div>
                                    </div>
                                    <input class="form-control" type="text" name="send-command" id="send-command">
                                    <div class="input-group-append">
                                        <button class="btn btn-primary" type="button" id="send" onclick="sendCommand();">{{ lang('general.button.send') }}</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <input type="hidden" id="token" value="{{ csrf_token() }}">
    {% include "Includes/Modals/SelectVersionModal.html.twig" %}
    {% include "Includes/Modals/eula.html.twig" %}
{% endblock %}

{% block javascripts %}
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.0.0/socket.io.slim.js" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.min.js" crossorigin="anonymous"></script>
    <script>
        const socket = io.connect('{{ socketUrl }}');
    </script>
    <script src="{{ uri('base') }}assets/js/chartjs.js"></script>
    <script src="{{ uri('base') }}assets/js/dashboard.js"></script>
    <script src="{{ uri('base') }}assets/js/console.js"></script>
    <script src="{{ uri('base') }}assets/js/selectVersion.js"></script>
{% endblock %}
